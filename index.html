<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FasterTasks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div class="logo-group">
        <div class="logo-mark">
          <span class="logo-symbol">⚡</span>
        </div>
        <div class="logo-text">
          <h1>FasterTasks</h1>
          <p>Complete tasks. Earn rewards. On Base.</p>
        </div>
      </div>
      <div class="header-actions">
        <div class="role-pill" id="role-pill">Guest</div>
        <button id="connect-button" class="btn-primary">
          <span id="connect-button-label">Connect wallet</span>
        </button>
      </div>
    </header>

    <main class="app-main">
      <!-- Wallet & network info -->
      <section class="status-bar">
        <div class="status-item">
          <span class="status-label">Wallet</span>
          <span class="status-value" id="wallet-address">Not connected</span>
        </div>
        <div class="status-item">
          <span class="status-label">Network</span>
          <span class="status-value" id="network-name">Base Mainnet</span>
        </div>
        <div class="status-item">
          <span class="status-label">Reward balance</span>
          <span class="status-value" id="reward-balance-small">0.00 ETH</span>
        </div>
      </section>

      <!-- Views -->
      <section id="tasks-view" class="view view-active">
        <div class="view-header">
          <h2>Available tasks</h2>
          <button id="refresh-tasks" class="icon-button" aria-label="Refresh tasks">
            ⟳
          </button>
        </div>
        <div id="tasks-container" class="tasks-grid">
          <div class="empty-state">
            <p>Connect your wallet to load tasks on Base.</p>
          </div>
        </div>
      </section>

      <section id="rewards-view" class="view">
        <div class="view-header">
          <h2>Your rewards</h2>
        </div>

        <div class="rewards-summary-card">
          <div class="summary-main">
            <div class="token-chip">
              <div class="token-logo">
                <span class="token-symbol">Ξ</span>
              </div>
              <div class="token-text">
                <span class="token-name">ETH · Base</span>
                <span class="token-sub">Withdrawable</span>
              </div>
            </div>
            <div class="summary-amounts">
              <div class="summary-eth">
                <span id="reward-balance-large">0.0000 ETH</span>
              </div>
              <div class="summary-usd" id="reward-balance-usd">$0.00</div>
            </div>
          </div>
          <div class="summary-actions">
            <button id="withdraw-button" class="btn-primary" disabled>
              Withdraw
            </button>
            <span class="summary-hint">Rewards are distributed in native ETH on Base.</span>
          </div>
        </div>

        <div class="admin-panel">
          <div class="admin-header">
            <h3>Admin panel</h3>
            <span class="admin-badge" id="admin-badge">Wallet is not owner / verifier</span>
          </div>

          <div class="admin-grid">
            <!-- Create task -->
            <div class="admin-card">
              <h4>Create native task</h4>
              <p class="admin-description">
                Create a new task funded in native ETH. Rewards are locked in the contract.
              </p>
              <form id="create-task-form" class="admin-form">
                <label class="field">
                  <span class="field-label">Max participants</span>
                  <input type="number" id="create-max-participants" min="1" placeholder="e.g. 100" required>
                </label>
                <label class="field">
                  <span class="field-label">Total reward (ETH)</span>
                  <input type="number" id="create-total-reward" min="0" step="0.0001" placeholder="e.g. 1.5" required>
                </label>
                <button type="submit" id="create-task-button" class="btn-secondary" disabled>
                  Create task
                </button>
                <p class="admin-footnote">
                  Requires owner or verifier role. Sends ETH with the transaction.
                </p>
              </form>
            </div>

            <!-- Allocate reward -->
            <div class="admin-card">
              <h4>Allocate reward</h4>
              <p class="admin-description">
                Allocate part of a task's reward pool to a participant after verification.
              </p>
              <form id="allocate-reward-form" class="admin-form">
                <label class="field">
                  <span class="field-label">Task ID</span>
                  <input type="number" id="allocate-task-id" min="0" placeholder="e.g. 0" required>
                </label>
                <label class="field">
                  <span class="field-label">Participant address</span>
                  <input type="text" id="allocate-user-address" placeholder="0x..." required>
                </label>
                <label class="field">
                  <span class="field-label">Amount (ETH)</span>
                  <input type="number" id="allocate-amount" min="0" step="0.0001" placeholder="e.g. 0.01" required>
                </label>
                <button type="submit" id="allocate-reward-button" class="btn-secondary" disabled>
                  Allocate reward
                </button>
                <p class="admin-footnote">
                  Only owner or verifier can allocate rewards.
                </p>
              </form>
            </div>
          </div>

          <div class="admin-meta">
            <div class="meta-item">
              <span class="meta-label">Owner</span>
              <span class="meta-value" id="owner-address">Unknown</span>
            </div>
            <div class="meta-item">
              <span class="meta-label">Verifier</span>
              <span class="meta-value" id="verifier-address">Unknown</span>
            </div>
          </div>
        </div>
      </section>
    </main>

    <nav class="bottom-nav">
      <button class="nav-item nav-item-active" data-target="tasks-view">
        <span class="nav-label">Tasks</span>
      </button>
      <button class="nav-item" data-target="rewards-view">
        <span class="nav-label">Rewards</span>
      </button>
    </nav>
  </div>

  <!-- Task modal -->
  <div id="task-modal" class="modal-backdrop hidden">
    <div class="modal">
      <button class="modal-close" id="modal-close-button" aria-label="Close">
        ✕
      </button>
      <div class="modal-header">
        <div class="token-chip">
          <div class="token-logo token-logo-sm">
            <span class="token-symbol">Ξ</span>
          </div>
          <div class="token-text">
            <span class="token-name" id="modal-task-type">Follow account</span>
            <span class="token-sub" id="modal-task-title">Task #0</span>
          </div>
        </div>
        <div class="modal-reward">
          <span class="modal-reward-eth" id="modal-reward-eth">0.00 ETH</span>
          <span class="modal-reward-usd" id="modal-reward-usd">$0.00</span>
        </div>
      </div>

      <div class="modal-body">
        <div class="modal-section">
          <h3>How to earn</h3>
          <p id="modal-how-to-earn" class="modal-text">
          </p>
        </div>

        <div class="modal-section">
          <h3>Task details</h3>
          <div class="stats-grid">
            <div class="stat-card">
              <span class="stat-label">Task ID</span>
              <span class="stat-value" id="modal-task-id">0</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Max participants</span>
              <span class="stat-value" id="modal-max-participants">0</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Participants paid</span>
              <span class="stat-value" id="modal-participants-paid">0</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Remaining reward</span>
              <span class="stat-value" id="modal-remaining-reward">0.00 ETH</span>
            </div>
          </div>
        </div>

        <div class="modal-section">
          <h3>Participants</h3>
          <div id="modal-participants-list" class="participants-list">
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button id="modal-verify-button" class="btn-primary">
          Verify completion
        </button>
      </div>
    </div>
  </div>

  <!-- Toasts -->
  <div id="toast-container" class="toast-container"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.15.0/ethers.umd.min.js" integrity="sha512-DYovdVHSkTDHMbwXgJSOqP8+zHqadNmAdfJbO1vEjhwS+kEl/HUo2p2mjAsV5dFaRKEbBtxCcSIkKZyiPhhFYA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="./app.js"></script>
</body>
</html>
